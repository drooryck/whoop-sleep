"0","##note: premise of time series = One Day One Observation"
"0",""
"0","# Step 1: Drop the columns with no data"
"0","daily_workouts <- workouts %>%"
"0","  select(-c(""GPS.enabled"", ""Distance..meters."", "
"0","            ""Altitude.gain..meters."", ""Altitude.change..meters.""))"
"0",""
"0","# Step 2: Remove the useless or redundant data"
"0","daily_workouts <- daily_workouts %>%"
"0","  select(-c(""Cycle.start.time"", ""Cycle.end.time"", ""Cycle.timezone""))"
"0",""
"0","# Step 3: Convert Activity.name to a factor"
"0","# Note: There was a level in the factor called ""Other"" with 1 observation,"
"0","# which was removed for clarity, since ""Other"" is no interpretable."
"0","# Note: We also removed the activity ""Activity"" also for lack of interpretability."
"0","# This activity had 65 observations."
"0","daily_workouts$Activity.name <- as.factor(daily_workouts$Activity.name)"
"0","daily_workouts <- daily_workouts %>%"
"0","  mutate("
"0","    Assault_Bike = Activity.name == ""Assault Bike"","
"0","    Cycling = Activity.name == ""Cycling"","
"0","    Elliptical = Activity.name == ""Elliptical"","
"0","    Functional_Fitness = Activity.name == ""Functional Fitness"","
"0","    Hiking_Rucking = Activity.name == ""Hiking/Rucking"","
"0","    Powerlifting = Activity.name == ""Powerlifting"","
"0","    Rowing = Activity.name == ""Rowing"","
"0","    Running = Activity.name == ""Running"","
"0","    Spin = Activity.name == ""Spin"","
"0","    Stairmaster = Activity.name == ""Stairmaster"","
"0","    Walking = Activity.name == ""Walking"","
"0","    Weightlifting = Activity.name == ""Weightlifting"","
"0","    Yoga = Activity.name == ""Yoga"""
"0","  ) %>%"
"0","  select(-Activity.name)  # Remove the original Activity.name column"
"0",""
"0","# Step 4: Convert 'Workout.start.time' to Date and extract the date portion"
"0","daily_workouts <- daily_workouts %>%"
"0","  mutate(Workout.start.date = as.Date(Workout.start.time, format = ""%Y-%m-%d %H:%M:%S""))"
"0",""
"0","# Step 5: Group by date and summarize"
"0","daily_workouts <- daily_workouts %>%"
"0","  group_by(Workout.start.date) %>%"
"0","  summarise("
"0","    # Sum of 'Duration..min.' and 'Energy.burned..cal.'"
"0","    Total.Duration.min = sum(`Duration..min.`, na.rm = TRUE),"
"0","    Total.Energy.burned.cal = sum(`Energy.burned..cal.`, na.rm = TRUE),"
"0","    "
"0","    # Weighted average time spent at average heart rate"
"0","    Weighted.Avg.HR = sum(`Average.HR..bpm.` * `Duration..min.`, na.rm = TRUE) / "
"0","      sum(`Duration..min.`, na.rm = TRUE),"
"0","    "
"0","    # Weighted average time spent for heart rate zones"
"0","    Weighted.Avg.HR.Zone.1 = sum(`HR.Zone.1..` * `Duration..min.`, na.rm = TRUE) / "
"0","      sum(`Duration..min.`, na.rm = TRUE),"
"0","    Weighted.Avg.HR.Zone.2 = sum(`HR.Zone.2..` * `Duration..min.`, na.rm = TRUE) / "
"0","      sum(`Duration..min.`, na.rm = TRUE),"
"0","    Weighted.Avg.HR.Zone.3 = sum(`HR.Zone.3..` * `Duration..min.`, na.rm = TRUE) / "
"0","      sum(`Duration..min.`, na.rm = TRUE),"
"0","    Weighted.Avg.HR.Zone.4 = sum(`HR.Zone.4..` * `Duration..min.`, na.rm = TRUE) / "
"0","      sum(`Duration..min.`, na.rm = TRUE),"
"0","    Weighted.Avg.HR.Zone.5 = sum(`HR.Zone.5..` * `Duration..min.`, na.rm = TRUE) / "
"0","      sum(`Duration..min.`, na.rm = TRUE),"
"0","    "
"0","    # Keep the Max HR for the day"
"0","    Max.HR.bpm = max(`Max.HR..bpm.`, na.rm = TRUE),"
"0","    "
"0","    # Sum of boolean values for each activity (to count the occurrences per day)"
"0","    Total.Assault_Bike = sum(Assault_Bike, na.rm = TRUE),"
"0","    Total.Cycling = sum(Cycling, na.rm = TRUE),"
"0","    Total.Elliptical = sum(Elliptical, na.rm = TRUE),"
"0","    Total.Functional_Fitness = sum(Functional_Fitness, na.rm = TRUE),"
"0","    Total.Hiking_Rucking = sum(Hiking_Rucking, na.rm = TRUE),"
"0","    Total.Powerlifting = sum(Powerlifting, na.rm = TRUE),"
"0","    Total.Rowing = sum(Rowing, na.rm = TRUE),"
"0","    Total.Running = sum(Running, na.rm = TRUE),"
"0","    Total.Spin = sum(Spin, na.rm = TRUE),"
"0","    Total.Stairmaster = sum(Stairmaster, na.rm = TRUE),"
"0","    Total.Walking = sum(Walking, na.rm = TRUE),"
"0","    Total.Weightlifting = sum(Weightlifting, na.rm = TRUE),"
"0","    Total.Yoga = sum(Yoga, na.rm = TRUE)) %>%"
"0","  "
"0","  #Create a new column for heart zone 0"
"0","  mutate(Weighted.Avg.HR.Zone.0 = round((100 - Weighted.Avg.HR.Zone.1 - Weighted.Avg.HR.Zone.2 - "
"0","           Weighted.Avg.HR.Zone.3 - Weighted.Avg.HR.Zone.4 - Weighted.Avg.HR.Zone.5), 2))"
